# This workflow uses PowerShell scripts to setup Windows RDP with ngrok tunneling.
# It runs only on manual trigger (workflow_dispatch) and respects GitHub's usage policies.
# Secrets (like ngrok auth token) must be supplied via workflow inputs or GitHub Secrets.
# No sensitive data is logged, and usage is for educational and personal data management only.
# Please do not use this workflow for any abusive, malicious, or illegal activities.
name: Windows RDP Setup with Updated Ngrok

on:
  workflow_dispatch:
    inputs:
      ngrokAuthToken:
        description: 'Your Ngrok Auth Token'
        required: true

jobs:
  setup-rdp:
    runs-on: windows-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Download and Update Ngrok
        run: pwsh -File download_update_ngrok.ps1
        shell: pwsh

      - name: Setup RDP
        run: pwsh -File setup_rdp.ps1
        shell: pwsh

      - name: Start Ngrok Tunnel
        run: pwsh -File start_ngrok.ps1 -ngrokAuthToken ${{ inputs.ngrokAuthToken }}
        shell: pwsh

      - name: Keep Workflow Running
        if: always()
        run: Start-Sleep -Seconds 3600
        shell: pwsh
